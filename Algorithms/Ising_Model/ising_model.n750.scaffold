/*
Input format:
N
Bx
Bz_0
Bz_1
...
Bz_N
J_{0,1}
J_{1,2}
...
J{n-2,n-1}
*/

#include <stdio.h>


#define N 750
#define Bx 2
#define M 25 // number of Trotter steps
#define T 15.0  // total duration of adiabatic evolution

// elements of Bz and J are randomly generated from uniform(-2, 2)
const double Bz[] = {-0.32011706618109104, 1.359500599953765, -1.966437962565927, 0.9421068856066794, 1.6284949868128238, -0.6331927379236517, -0.6065111970057333, -0.8216804460447777, -1.4040356974373616, -0.5388342774982138, 1.3745820836455676, 1.8122745560267366, 0.3968422538977525, -0.7803270819460395, 1.751045170826039, 0.6574758659860693, -0.33807493901364394, -0.6077961584878908, -1.6391132680320246, -1.7572658832299126, 0.561239418212562, 1.75293359059508, 1.0598208942074532, -0.27924226589141643, -1.3231842572859214, 0.07371384144689008, -1.3452505559459143, 0.1225953822914474, -0.6564124934491131, 0.4533438119012123, 1.8361659583667538, 0.15966746875179183, -0.4052322296338349, 0.1053155546925697, -1.1101234674061407, 0.6957461319220415, 1.3274761155357022, -0.7946710954086731, -1.6344524729406542, -0.15778240884346761, 1.1119550468944794, 1.3775308050799753, 1.2047672423701434, -1.394406082635507, 1.3368358634799642, -1.5069010435679133, 0.6773547216655942, 0.011192890445927084, 0.6823840110631978, -0.9013592934181434, -1.5382858731814428, -1.9435335774594211, -1.323730653007626, -1.9856895337487583, -0.2039014769744809, -1.494056532709612, 0.5031989055252786, -0.15695510606443008, -0.9402553979194002, -0.13253085730155023, 1.7252798931869, -0.9933316908151757, -0.9399305322307026, -1.506262878710519, 0.661414255761053, -1.631636716025882, -0.9862591314239761, 0.03752164300603278, 1.6991092742987814, -0.0945738120443198, -0.41004742486810786, -0.968087611233654, 1.116572622234203, 0.6927930080431919, 0.04391144619936371, 0.0385307262988408, -1.607982214516424, -1.688464842478672, -0.09900719154068183, 1.3356243635352745, -1.675799269666837, 0.29213266796902415, -0.8672996079771926, -1.4828036469490402, 1.7654792521910116, -0.6030440011319214, 1.0863863846430606, -0.31325479581375504, 1.2350517070121105, 0.7792353138932047, -1.411474006871413, -0.14804909543656608, 1.005842501352019, 0.35571427619202156, 1.117109550006465, -1.7581541386394894, 1.6421307373929226, -0.14350794597880556, 0.8590520474885905, -1.798391913885843, -0.6001640711171476, -1.4476826626032024, 0.45114823781093083, 1.9880886228649284, -0.7119982402461935, 1.6288863370122595, -1.7407578633651721, -0.7261257462863466, -1.594581661567144, 0.04383022839165429, 0.06806102164082395, 0.704805519647409, 0.3200923643682403, -0.34212560492793065, 0.43944924358463755, 0.30956965750687493, -0.7759689789625881, -0.0986817055497613, 1.5108563992616006, -0.17673463457741256, 1.806364630002554, 1.9036114691288581, 1.3581216509774872, -0.1005274614704259, -0.3199514252142235, -0.2239938478509802, -0.273812357316213, 1.7799552693401193, 1.505306296755529, 1.1056222108002411, 0.13295600309455002, -1.4097563304322995, -0.5325296717203631, 1.8527655187710788, 0.743906920295994, 0.6350068224945278, -1.2945905169413838, -1.871267737995343, -0.5054295606179848, -0.9783168822361903, -1.1641282864184923, 0.876255913370215, -0.026622134508975215, -1.2160253781113175, 0.1952555208548672, 1.972704894076835, 0.3395935992352026, 0.22580800582345617, 1.2728947338042378, -0.45706338484263886, -0.27095306572572797, -0.39254510632788664, 0.7956500885279834, 1.6425312659168845, 0.29947618721223757, 1.853095095817142, 1.6677492142313253, 0.38175262165266055, -0.8356568392436126, -0.5161109479671562, 0.22182104017441073, 1.0270740954722166, -1.444694247544004, 0.8056970056131303, -1.267082756685011, -0.38447062136843124, 1.5406713525112727, 0.7575442778144259, 1.2022467403816393, 0.03491060012998659, 0.39843663486939684, 1.4878827291355505, 0.26483778177980666, 0.233709332778111, -0.36776861978003783, -0.5556808257493238, 0.14842191452563602, -1.7716429729929914, 1.1577026995940938, -1.202964653407724, -0.900561003283169, -1.9782967228524875, 0.4467174973395909, -1.675202347301401, 1.6486773513922595, 0.8367233356333674, 0.5015456966087268, -1.5955565609420068, 0.8131696065690668, 1.0049854072374083, 0.833904998285893, 1.7306804447112816, 0.609963412137188, -1.2453120003145846, 0.9562948250861942, -1.5176983314234023, 1.7610356695277578, 1.3708344511096744, -0.514672007845355, -1.8310287115125572, 0.8961527043785722, -1.8296514293823871, -1.037977073278999, -0.9928803968458411, 1.5516700123841134, 0.20066023108135278, 1.6256737571678541, -0.4581955827933055, 1.9779301253013943, -0.8920604599441169, 0.3900169977305774, 1.7519486098956358, -0.9034365459923959, -0.7062924591630084, -1.0134968368631392, -1.109864256765409, 1.1872917416234898, -0.03409119644664571, 1.97606076011389, -1.5881917789934805, 0.055931369432264066, -0.6826700605436931, 0.06231973648899558, 0.5655014633880282, 1.1009394342833527, 1.670336267373858, 1.3537223051585499, 1.4166076499074722, 0.9797138979886051, -1.3008636302431822, -0.7712940752867188, -1.8350152801583852, -0.04442094602479019, -0.5379520214124942, 1.1446670688740412, 0.8580873577274897, 1.4680124148406852, -0.21230779827944835, 0.30120128519425426, -1.3377396578980547, 1.7586817335122866, 0.2873821307582589, -0.9318058430359257, -1.1356937678104018, -0.2942650244437184, 1.522555029223954, -1.0681988771609765, -0.5584081438146171, -1.7011501251082124, -0.32869915904062097, -0.9085972714474404, 0.37154302708890974, -0.8649400963188865, -1.9798015684059376, 1.8340655140722868, 1.0705370489839363, 0.10075468265152576, 0.8184504533910344, 0.14476838590936802, 0.7402813427865982, 0.7119652942522792, 1.8204878246728793, -1.5025222483461311, 0.3560737664847369, -0.8426978093863737, -0.8242059779118049, 0.3469258961777695, 0.14874033367888373, -1.1826386004284455, 1.6501978198133762, -1.5054442636634704, -0.9828526949274563, 1.6677612635799326, -0.3463905410884953, 1.7658407335290485, -0.38328671213530763, 0.11618518718031723, 1.563929039132597, -0.8921838400063096, 0.3056699671242633, -0.6765144437455941, 0.39621520329023374, 1.4118044679680217, -1.9346752831428238, 1.4860415603541983, 0.9319120613806628, -1.3564237551618152, -0.9096747587317364, -1.4595854096999759, 1.894697501811129, -1.3585199466623692, 1.7269703298633234, 0.772529161698297, 1.3335420712400916, -1.1038199406949536, -1.5725870222560778, -0.2380765598780421, 1.7715131204808414, 1.3938254035256596, -0.48774256358311696, -0.6873441107697134, 0.6979471581882395, 0.31115195193445366, -0.4570427690756955, 1.0191119246530356, -1.835394753210473, -1.144714908807528, -0.3824393204938472, 0.10602589853304822, -0.38275286980276, 1.359555542338362, -1.7694407343376173, -1.2831236658321745, 1.2326155865848052, -1.0167669318438164, 0.4155044321428569, 1.950621621107849, -1.5744034252582808, -0.42630487910927295, 0.6598197433027075, -0.9232943718529274, -0.7931456072450622, -0.4392135558024872, 0.3434275299326508, -0.8503403815529031, -0.8278887404231159, 1.5535532706542932, 0.5606652034782376, 1.4214815557751614, -1.5722860689536873, -1.7554357787410582, -0.44807659604267336, 0.816079872758511, -1.126872122333328, -0.7586093971482386, -1.651305687448946, 1.755020892286797, -0.9509639117138731, -0.3893637053839072, -0.5262363517701658, 0.8284355833178276, -0.369535507769283, -1.19226953128135, -0.06080907282784098, -0.8378719394694176, 0.48782298926481094, -0.7181776757669969, -0.28941353335722253, 0.7738087395574462, 1.0906923220593199, -0.7075905497734971, -0.5441609811054917, -1.0408277349743416, -1.069216842453403, -1.6832103799847946, 1.3792380165462519, -1.7333552016093994, 0.45505530823473883, -1.6203038700645105, -1.952575890874452, -0.0036118042084538615, 0.6633138235029139, 0.8277647400807626, -1.6566253259120072, -1.0957198385215028, 0.39782237246115626, -1.3989254773465838, 0.508888001365996, 1.0063859580009469, 0.5581070068592315, 1.872929883090348, 1.8841658018876721, -1.0537049045153393, -1.066293910032785, 0.4230843581998114, -0.2849950627797089, -0.9104933209485901, 0.7879486343831363, 1.8991152261142314, 0.615672115220292, 0.6506097756439724, -0.010369758406320706, 1.007755137614486, -0.6543943691908156, -1.710970493173627, 1.3862728403325075, 1.9261807196301626, -1.201686959294293, -1.9931038106771823, -0.5032880256017118, -0.2514059536940678, 0.5216279300338269, -0.06093457217111409, -1.3348929161833003, -1.9029052076410462, -0.2278033250518039, 1.481728538082995, 0.3831844460147802, 1.4075308576359356, -0.1450430914625902, 0.10050125905257135, 0.2148790692110043, -0.7572402951806532, -1.8265152503961137, 0.21378395836944541, 1.8429880547653004, -1.6864247317398795, 0.8000273121660433, -1.0809953191284896, 1.9522014373760723, -1.2869882210943073, -0.06592611091152634, 1.7533679997666733, 1.6815177347334678, 1.0892361046207415, -0.6099754988998662, -0.48747844603537294, -0.7880265532359187, -1.67253154828997, 0.4320997236062105, -1.3119806729366195, 1.1783673735657874, -1.5436469459922226, 1.3710033399526806, -1.6568178445989385, 1.4720283328398849, -1.4739589823509855, 0.21593958949848924, -1.78326950135452, -0.1072631765598282, -1.7093188534617507, -0.6119551692062948, 0.13511407505463913, 1.1514346592867235, -0.0036645469872715886, 1.2511083069808455, -0.4402381383306655, -1.8776396742569816, -0.9451869954390517, 0.7481997486834735, -1.0738466633795962, -1.0850620782457212, -0.6164431164502893, 1.6523344756242828, -0.6000339634303251, -0.6333223395925738, -0.7249729707891501, 1.4061791723760253, 0.14192397540339208, -1.6732393278960616, 0.8533054857618527, 1.5371471974097823, -1.6602045008556852, 1.7797650005467158, -0.9728272428058671, -1.2091826993448391, -1.3495956583972992, -1.9943221554934998, 1.4253582852359101, 0.7943057787717094, 0.5757575568414235, -1.0529014557231613, 1.0918623017942042, -0.5490222179746245, -0.5590422361698395, -1.6122287406003144, 1.0816012473642216, -0.7467591694198914, 1.861370471670372, -1.6146093973654185, -1.9373346844357022, 0.6300019127154179, 1.2413549716966723, 1.2815877764007295, 0.3063094878998216, -0.7142294733120176, -0.9197445867382745, 1.1704393997667775, -0.005420505321505509, 0.0998815014779404, -0.20382403807807492, 0.4458272146215192, -1.407495004876088, 0.990931149530049, 0.2967876221788548, -0.5456627885569048, 0.9601740723233632, -0.6216633598746082, 1.1647467426756792, 1.5273957388399646, -1.2205310415799806, -0.7884107862631593, -1.4237597889265174, -1.2704418875180323, 0.6487539074304456, -0.9653323240309977, -1.1960590124656867, -0.6377998524996431, -1.93965215327519, -1.715102247357863, 1.9352075994636087, 0.15507395483440956, 0.25135753602917443, 1.35021137366047, -0.8552125054388222, -1.4800800748660041, -1.8903013906774593, -0.18036814800112477, -1.248957356710017, 1.811468532253127, 1.273610425121642, -0.8402260899057934, -0.8682044633662023, 0.27025746388025507, -1.5718616758319763, 0.6337388588989246, -1.2531974177291794, 1.6800237432479093, 0.11445300236948208, -1.2998666930502099, 1.0323958182969664, 0.013864455227334371, -1.262742302085059, -1.8396683025882843, 0.14353981607021327, 0.09693472872735232, 1.5983789492322429, 0.24896074682932756, 1.998375508883071, 1.95495520780146, -1.1125161019843648, 0.21438669500710406, -1.735606140331401, -1.4751812049723925, -1.7362824495086069, 0.9782100191152687, -0.3495233879635027, 1.9332659763738662, -1.4260176498338022, -1.9897580608920764, 1.6113493887796362, -0.8196493418673727, -1.9665698060024766, 1.099621315614761, 0.9769545241363771, -1.2836829725270031, 0.26791446627820337, -1.6751798700363665, 1.4913233743996939, -0.6606812791019547, -0.5160576754959418, 0.4383322604864017, 0.10179460154971132, 1.414861414896349, 1.1892247193187329, 0.6322871809509047, -0.3230414433550366, -0.724848977252873, 0.8506161638445566, -1.8074527103301743, -1.2687605936206618, -0.9411531079445363, -1.4386824924748396, -0.9636117352643079, -0.8964006922651984, -0.5225353544128462, -1.1204636112130735, 0.15317889231833703, 0.6895319130434747, -1.7473193694595168, 0.8829282448991633, -1.6085692083333853, 1.7855368370266227, 1.246675270356795, 0.8473184345350009, -1.0375308140792496, 0.4237060707971567, 1.1066133233194342, 1.8527299536984794, -1.6972969656411503, 1.5011991674687102, -1.0447639609692554, -1.6187303824586032, 1.3399645271076732, 0.6496852461047169, 1.7164689051509163, 0.04938766055267063, 0.4017476828086335, -1.9462099102140606, 1.4392167216134037, -0.8674104595626719, 1.879168295766421, -1.5122134901234343, 1.066913136820634, -1.3421298145637857, -1.502795847394108, -1.2588509508511105, 0.7468187909396438, -1.0568142728898549, -1.042885643830663, -1.237682799704877, 1.1111839227509304, 0.3639037698326457, -0.8220833917133308, -1.2553422118746091, -0.39180150847411754, -0.10587574204410899, -1.917418114258178, 0.25323648458965664, -0.2388527595751797, -0.9898589039550219, 1.8655381146586518, -1.4730062574916905, 1.6624244471449532, 1.8178844586426988, 1.9404512316687041, -1.408576692338809, -1.5292409073005802, -0.6016766889212373, 0.2594686380705111, 1.0530881326312178, 1.3478129926964102, 1.561321235682768, -0.42406467287430427, 1.8752186592195028, 0.7180076709165686, -0.29716187055264554, -1.21885868948659, -0.2577204021681547, -1.8318172269592798, 1.7108780045826828, -0.8715362162142459, 0.10078130348395886, 0.1981170254920368, 0.05306863472362, -0.2717269363578123, 0.9718054688872866, -1.8129126117166745, -0.11579217670124509, -1.752050817587444, -1.3386296938348243, 1.405010828144169, -1.6728933412121152, 1.3232609809698204, 0.6274580474555247, 1.4029562830340248, -0.8943171785900188, -1.5376314520418433, 0.05043924404103528, -1.6604661537946712, -0.079707127060896, -0.33932582937908684, 1.4251456462441547, 0.21538882954743332, 0.20083641761431226, 0.15461410671483478, -0.5342692849557666, -0.4353350165098191, -0.5036054373994685, 1.6528099429210705, 0.3715411505549473, 0.585242294964821, -0.45459248492746696, -1.6406870045983757, 0.95516964696218, -0.6536262235254555, 1.6853970586175944, -0.41417604446741985, 1.349411219222941, 1.6154730331285867, -0.06721949404484295, -0.2136072944364833, 0.0858531487857137, -0.20322095401850904, -1.2899210269756893, -1.0502590936244829, 1.1948754340656964, -0.15592050898813925, -0.6803348695062401, -0.8188356714523461, 0.31411107634610724, 1.6124824691111983, -0.11142059629223322, -0.19867781811036966, -1.2652533351827127, 0.912080877909915, -0.10255396252082871, 0.10249477972862309, 1.2472037068768502, 0.8764959558846224, 0.4685427548938459, -0.15255885548247772, 1.4325560331694964, 1.407994152765995, 0.961687829180204, 0.31317884438313337, -0.09571791543655106, -0.7900122785148249, -1.6417465835985334, -1.094110262460903, -0.6620330875589437, -0.2719223314957322, 0.027619978750754726, 0.35633805806657515, 1.5052155722135057, 0.07419187199214061, 1.668538715010937, -1.6437109159243009, 0.15053340495832623, -1.555643470881289, -1.615424618084869, -0.6147667599434401, 0.5402424201098963, 0.5501681329024839, -1.4520145666193107, 0.23503531886615292, -0.11964854679551618, 0.7837264837721052, 0.29076167565935895, -0.8182567247034553, 1.9125980550433686, -1.6017791199748967, 1.7347454379137006, 0.7169670779195796, -1.7463507323030996, -1.368832499930385, -0.03960099958002994, 1.6359310451308282, 1.499345483239805, -1.959655175897327, 1.7563982473896873, 0.7153693979525326, -0.9120746709285648, -0.2381823083540917, 0.763749079946856, 1.9495527465945224, 0.9421381642526594, -1.1357688179052894, -0.06707054988405492, 0.6170360292940713, 0.8512870801692838, 1.2562748316570373, -1.1074460215590047, -1.781960297296183, -1.7474029346992284, 1.0990265075133219, -1.512694479739923, 0.16915882709853136, 1.2248161248221816, 0.6699017717655367};
const double J[] = {0.46074124792689064, 0.7520398118803575, -1.4806126701201063, 0.15205595524003046, -0.6675582271104266, 1.1255591610937459, 0.9046938399513573, -0.9799158674588382, 1.5702439422542507, 1.6943197365371487, -1.4950899748675766, 0.44855246566126716, -1.9898356575578333, -1.6670015562733012, 0.06440901322823933, -0.285227718790793, -1.6920060021792178, 0.8306614255857445, 1.7324076454090473, 0.04966103615672557, 1.6366171931671283, -1.8411087473331822, 0.5290881590691239, -0.8567485529141328, 0.9494990431789514, 1.2138499843968824, -0.03958541419904371, -0.1122735642094903, -1.187115182118255, -0.7000912757662006, -0.8681765410891416, -0.05353655136861413, -0.4190958365395878, 0.07038196699519927, 0.7786155394198069, -0.3033715338444214, -0.8178225258700107, -0.6096202298074767, 0.17051608460484013, -1.9297686855788139, 1.3979735402179387, -0.7665450845539024, -0.03694827310968263, -0.4905141375080113, -0.5914296345826009, 0.6530327957959563, -0.8071795682277583, -1.9291643383482922, 0.43179215567528484, 1.8781007667908227, 1.1628950180901985, 0.27469218181076993, 0.509252364561644, -1.1559488828699505, -0.5874473528268265, -0.5713190766522662, 1.9166168549128813, 1.0047180386084156, -0.48215097510769933, -0.6023329839249976, 0.9000978908228685, -0.20758660634539838, 1.615754208049934, -0.6624369287311889, 0.9142134000237596, 1.478293937641661, -1.994527859771019, 0.7488474133656919, 1.9810497913468654, -0.7172628769623515, -0.27233835718490473, -0.4269884641260284, -0.468387989127097, 1.7023287616967906, 0.7551181720363407, -1.648495976996427, -0.7751199637765414, 1.4303798013884466, -0.0015637232199599005, 1.2769753183150323, -0.9816552786474602, -0.5223292179380778, 1.5430149461202203, -1.5609670437443044, 0.47110289514635406, 0.4516516464988847, 1.0616157480853134, 1.0480161749934185, -0.3359296605037785, -0.39658061983207515, 1.7476756901917208, 1.2420572114239148, -0.7339344777515038, -0.23843891922241145, 0.6310798137066174, -1.2103149559878221, -1.5002745224494292, -0.039376825121945735, -1.798592588974945, -0.3639172551319052, -0.2366964700500307, -0.6633992655175622, -0.7513838296005311, 1.2837514475652876, -1.2271318757060206, -0.22655930967951798, 1.8896262488363664, -1.247269512944265, -0.06410506705206043, -1.3432509366639245, -1.2973537642401212, -0.7509378334780288, -0.7330135437555914, 0.6663999485126624, 1.3366893339461194, 1.8766718507156623, -0.22108195865023061, -1.569989413875812, 0.7896439792883658, 0.9461587977834562, 1.9735626944455125, 1.227485621970068, -1.8764759437075775, -0.06330963932313027, -0.5357210527889094, 0.26692605396721714, -0.6997787177990729, 1.9973122484285941, 1.2057645861754156, -1.4763308157925117, 0.6193084362721977, 0.07057172706053594, 1.7262443303545711, 0.6461356846482809, 1.0461519312904715, 0.4656907765214253, 1.416111006044399, -0.025488134545731622, 1.7634789498000538, -0.16184173854639505, -1.235267960505905, -0.3762080729801913, 1.079997246890127, -0.5865781288764373, -0.7070740110459868, -0.08846996792308559, -1.0207566917753166, 0.09121222952196018, 0.3480923155435405, 1.1103642681308954, 0.4153646938469464, -0.07471153007538334, 1.7596585100185407, 0.11153596125457632, 1.4177843181248204, -1.3395551905826708, 1.37857334732435, -1.5499660907862394, -0.7774900764400483, 1.222980689672704, -1.4666791065513274, 1.3438692158240135, 1.782788754206257, -1.8542589632588524, -1.2031706444978334, 1.8120252026945032, 1.2601133364003623, -0.022510815310957444, 0.9772884078833077, 1.1907645723957239, -1.5537323083807775, 1.6147325880385117, -0.16413544434128857, -1.6769930632270627, 0.23526061467416381, 0.22448988522184843, -0.2079531811669657, 1.8720118952726201, -1.080691566089813, 1.223018814195287, 1.2825445559444, 1.8026570289276522, -0.48937663472084125, -1.8750903484941897, -1.3536297642007815, -1.4346024337049625, 0.6594636016476754, -0.28461392150668674, 0.36843197386089876, -0.5471143710038295, -0.8274878240366852, 0.06500957313860978, 0.6173587334149238, -1.1199444990853569, 0.6325687333000971, -1.1139798320769092, -0.5097652658562319, 0.4402794182240233, 0.499265729273755, 0.4193886921039507, 1.9256282133396665, -1.5422886046035544, -1.0992753794436996, -1.2782582537861034, 1.2669950421611214, 0.5251999229651996, 1.1984503172075511, -0.43927856741825577, -1.5971989488356697, -0.5971915675381876, 0.14165625669294313, 1.4518724810908687, 1.7535222037334655, 0.6299562910585506, 1.2573397901241505, -0.7845370792709354, 0.5005269235563654, -0.9126708541905355, 0.24948776316929022, -1.193294199534543, -1.2305236322408035, 0.39530828328026946, 0.07025764755139541, 0.5921336677524884, 0.38454461883193103, 1.533506558971483, 0.6429449084809651, 1.4021020554149572, -1.7874383472338171, -0.4575190170356911, -1.8504288404426705, -0.4506034406851125, 0.9107529394814144, 1.907896666653493, 1.4189362930471519, 0.2453286404129016, -0.8335033152973987, 1.9548004510355055, -1.119501166119338, -1.2329684057444985, 0.13094279944187015, 1.0272315473677032, -0.08162847276185126, 1.4666344919303689, -0.8967662746078213, 1.8469402521311955, -0.051973567849216806, 1.1631275714447273, 1.3032560274868552, 1.717762686939888, 0.6618873144180646, -1.4958694407933537, 1.1730328982100584, -1.0381153416498532, -1.3257438438009341, 1.479821136253773, -0.7071235383722585, 0.29212223305322027, 0.6710669381645582, 0.5289308316068815, 1.2771664307350026, -1.9674056207415789, -1.2301576450320493, 1.7682661596255649, 0.040244286436187604, 1.2317204344200197, 1.0043713292458385, -0.4468248599438782, 1.147321620769839, -0.5036255470059912, 1.2909585015731375, -0.6393319547914311, -0.02223996118021976, 0.018232006479920404, -1.9724019310009915, -1.9903868177888007, -0.8699512743411368, -0.23292339261106632, 1.6498988368526324, -1.9048091306666493, -1.455620293024869, 1.5529831793339817, 0.9819859914455598, 0.5280729929347268, 0.05569246948408635, -0.5208507720903639, 0.4360630920580224, -1.999734787079475, 0.764941611913569, 0.858872690535375, -1.4727154724358162, -1.1591309915455423, 0.8012471419864484, 0.7198614802103651, 1.6783609083653275, 1.178659854823405, 1.2267456728410524, 0.6775388519108994, 0.9646261976454404, 0.7882481360458145, 0.739853872756886, 0.8157889130449347, -1.0026725923720123, 0.6726972322233333, -1.5056578205969071, 1.9984076114812845, 1.1226931958349913, 0.6938542740262346, 1.5905465151598324, 1.4476627315983568, 1.7206922174072958, 1.3626718499412327, 1.1972173712512135, -1.931246426029578, -0.15348628673358267, -0.14322581587105843, 1.6713389275155057, -0.9150649006268994, -1.9099118704478806, 0.08650438266182325, 0.4907016566355651, -1.1527604688309583, 0.1501850164926437, -0.4927387975673714, -0.9032188260384366, -0.13323782663357964, 1.3666574686867508, -1.5929021394301053, 1.2909903414691248, -0.2835964444415393, -0.2522730064194971, -0.21908899732275744, 1.554251453728558, -0.9881368917023954, 0.6308620631785558, -1.6221811123156757, -1.4108557305610496, 1.3303024821259308, 0.47010869192513116, 1.3792001831700276, -1.8454050171807586, -0.6188333074992292, 0.9941082672782939, -1.087022662215626, 0.8717551956841776, 1.3692182250212457, -0.4670999680384771, 0.5681847782347322, 0.912832751054844, 1.1773846215054853, 1.2203114310719823, -0.05058814164028824, 1.838990872970101, -1.134726774802048, -0.16357320628295513, 0.3964416447267407, -0.06635685894026189, -0.37652781054753204, 1.2338754356112545, -1.0466009913703789, 1.4314688999077472, -1.277310951261534, -0.1477553157927174, 1.1082077675301658, -1.3440789495140875, -0.5528326054323958, 0.6165233449349556, 0.5667227680971476, 1.504054223410081, 1.800829791684762, 1.2225914532615931, -0.4888500191556404, 1.966724447750341, -1.486117220104005, -1.0719006223726524, 1.8712740927129685, -0.07995755821821282, 1.8444412978320437, 0.5190950173391502, 0.4416612101083732, 0.591294515880378, 0.5265886474335844, 1.5652060235965224, -0.10187680713394487, 1.8335001681797842, -0.04562242161992369, -1.660836987244994, 1.7355323286045792, -1.5350880876309931, -1.9511634354627887, 1.5247389056443894, -1.7847548776807667, 0.5436717608440786, -0.8983813020744944, 0.9885724855209901, -1.9937370736192324, -1.4504750160823945, 0.1899237996813108, -0.5849610887626024, -0.4645755017412485, -1.8483066287363101, -0.726167280801663, 1.8044272904768364, 0.4327032185214761, -0.8270228870722827, 1.8599985486547252, 1.8784061912066714, 1.8771276741627112, -1.611564288254883, 0.5447064141248426, -0.4647750236926771, -0.05179148424396729, -1.6175620676381488, 1.5717093710716736, -0.4560505048701855, 1.178320569940245, -0.5980345221164551, -0.37007674818247027, 1.827595021881128, -1.025719858555627, -0.4196041081088331, -1.9746069896412837, 0.6890245253815301, 1.2487187256482488, 0.7001748698815589, -1.48539887388816, -1.940553020001175, 1.9486060702338106, 1.7780811464119477, -0.8864903142661649, 1.0978360347436897, -0.543589860107776, 0.339636396773519, 0.2881983805703032, 0.5159560160319709, 0.16181932086599948, -1.0054907091047984, -0.8822453750496067, 0.7483698374860466, 0.5260699024629969, -1.3405040676801354, -1.2380562425673105, -0.20976100402115438, -0.5190297348673956, -0.49086792617568786, -1.2968295777748176, -0.5294698337812513, 0.6987906133517696, -1.7361226898820132, -0.6511591840489879, -1.769892887635609, -1.552577933147416, -0.7874719330609059, 0.9233074819157094, -0.3080701804666637, -0.5260381034162758, 1.8913579805856156, 0.4286756956428963, -0.9552520880290958, 0.9888533597867761, -0.6422238175359039, 0.9208746853369494, 0.8321025048876947, 1.5837913411020925, 0.40859744316798974, 0.6077287664712916, -0.8772565676955342, 1.0021189272007227, 0.6643779928186628, 1.3151581400895664, 0.30807047727834735, 1.828158324101548, 0.28408033288263557, -0.03400511196719069, -0.06851528895808556, -1.2108803039665959, -1.3142638245180143, -1.8792116131741707, 1.0971474952628761, 0.007762601641123634, 0.3910194376047924, -0.9106882380568977, -0.3551857734305215, -1.4829876983540777, -0.35180784230143924, -1.6408741433123977, 0.45625470777263955, -1.3056385990680832, -0.22039263850400426, 1.2929084183199224, -0.2899724925770011, -1.815908271680096, 1.3899298051682183, -1.041115726998374, 1.6122254332976125, 0.3460127919401619, 1.1596013983301172, -1.2955764632859252, -0.38837475246261377, 1.036285102412383, -0.7847829372934654, 1.0541835968706335, 0.00892948616032685, 0.8508779135901476, -1.7571740029825285, -1.245739434776711, -0.0036687074383565665, 0.01903839309272426, 0.06944858770506368, 1.3684865291921384, 1.5027425416685034, 1.0669004520666325, -0.9852962111651649, -1.6154648706634251, 0.789159037917889, 0.7230244114668074, -0.18968795782891057, -1.3678549312539388, 1.1726678124956873, -1.2280177708005948, -0.7724279511454677, -1.3974018895915261, -1.381719947083401, 1.992010347767208, -1.7251899467660787, 0.7479759055164727, 0.8664279180300385, -1.5065908822401721, -1.0564992790875456, 0.2500752196864786, 1.2579754224222586, 0.0035128255588321444, -0.8821284634353179, 1.3138202465449278, -0.74320835060611, 1.3239856039587985, 1.6878901549795295, 0.6429041834215168, -0.38102157374162093, 1.6316110585394785, 0.02670664626382324, 1.6911027396310438, 0.5743516088090361, -0.2234547462012686, 0.08557926019499584, -0.33815431929522655, -1.1471419229933493, -0.3204669732463854, 1.4112226633663565, -0.6058540805376178, -1.8788823590531782, 1.0877413492623846, 0.08001180387841478, -1.2232069229344158, 0.6874508528291212, 1.3574400832299784, 0.689809290033129, -0.7430241557251702, 0.626827228477775, -0.5591733249271029, -0.30729190675323936, -0.7110451815240348, 1.0726438453627125, 0.16678498552817578, 0.8198073140183118, 1.0335338610433724, -0.21311198916332064, -0.34413603922333325, 1.5526573338611875, 1.709521863060551, -1.1897192015423892, -1.5631406051564656, 0.8277491400396872, 0.7389033567981689, -0.6770668750288018, -1.0819505194643795, 0.8225139880711807, 0.0034059449123433616, 0.5857526439702156, 0.36005323947547074, -1.502687523398487, 1.330285156542093, -0.5808780607345061, 1.5716320118886995, 0.4799141411317329, -0.6700166117618638, 1.1865367416303645, 1.1426175754920256, -0.6051383423378573, -0.3297807152196106, 0.9618239886104498, -1.6771257419302388, -0.26380868302401606, -0.913167663671266, -0.5985682963216314, 1.9285869825098176, -0.9455086197001137, -1.5966517002494842, 0.9037818376932725, -0.8469747674499977, -0.28847014702141927, 0.11664277650240651, 0.7142626610871599, -1.9920309326998642, -0.13885248951772988, 1.034953846752717, 0.5216277511111649, -0.19077129757973843, 0.4350885730100731, 0.4787228659974123, -1.3354245276745371, -0.34855868610681684, 0.9747025735008692, 0.11343093181642461, -1.6599189405241992, 1.2067293805772041, -0.40233129518993715, 1.5624077971374137, -1.5911178770411571, 1.2257703039673173, -0.7303641824252232, -1.625721509162982, -0.751884317603225, -1.038085480945346, 0.942822032460346, 0.5204430332121377, -1.9097783475815722, 1.7995669631884832, -1.3032402388717528, 0.46280232268734345, 0.254622215881843, 1.5994944844287202, -1.0247093716070705, 0.5009793329953651, 0.6530981530641284, -1.0947091298322267, -0.11456536275080254, 0.04503231997815593, -0.7598416114893136, -0.5439431590112807, -1.9210692975273416, -0.7400232549282189, -1.1127604117868333, 1.837020228294278, -0.5508647029296703, 1.4330554271466442, -1.1970346718921312, -1.767419589092889, 0.41357728933375393, -1.4883804889845038, 1.8114281128518166, -1.3212093989687288, -1.1658259838345977, 0.2201520805286874, -0.5036784055445942, -1.4693681449303506, 1.2008230963967916, -0.9360986112800318, 0.37291237020553103, 1.6902857114768333, -0.43015363818627117, 1.6117560223007654, -1.6600219943285026, -0.10154666037078863, 1.6809762610717107, -1.9620813526824263, -1.3948139284423258, 0.16194496063101393, 1.4419312302348217, -1.4494404913308525, 0.23730465977877824, 0.5462421351453148, -1.8805318514138194, 1.291742018827371, 0.4020281147683056, 0.8202266612978488, 1.0255205740470288, -1.3658239680820303, 1.51902912768985, -0.09720061974091143, 0.8308068755952709, 0.6717498416331664, 1.8804545221302407, -0.5667646351478832, 0.4953074854848367, -1.4741352681966382, -0.898986455635713, 1.3046544572255114, -1.5459054892993889, -0.6495742271915756, 0.7950038517379587, -0.9368767354151459, 0.8015609930798266, 0.7141850419170135, 1.2364141245600782, 0.7278630943296167, -0.7571361889357937, 1.838808378255588, -1.838304801108567, 1.5742659935428787, -0.7221975485332108, 1.6708136881129723, -1.356124088869041, -1.0093450635575563, 0.5869347626910257, 1.056676649524658, -1.693414278597551, -0.5736105792468096, 0.5191960005743343, 0.7751592900888444, 0.27919820946595353, 0.9455927498101584, 0.5783699521764518, -0.484676913702645, -1.5923129059476393, 1.6000624155714345, -0.33246488645345806, -1.865101478228107, 0.6853061363317021, 0.9333137386506647, 0.24641953402962935, -1.5002029189095767, 0.7292629034885394, 1.848985985433175, 0.6637424890019363, -0.6366547053845046, 1.7980107501882734, 0.9503955831726847, 0.48158062010815517, 1.5008331585192667, -1.6580745957262395, 1.156077819503384, 1.9384136867242705, 0.11374180687593771, -1.090882489477396, 1.1897603302447735, 1.4019345199139281, -0.5884364028721136, -0.8946238657255274, 1.6017428127255662, 0.1503297326291495, 1.9792455440584877, -1.8499230687034478, -1.165568159087485, 1.2218554533962473, 0.25369721615502483, 1.144897365227171, 0.9957342741804323, -1.740270752290813};

void CZ(qbit q1, qbit q2, double phi) {
    // printf("performing Controlled -2phi Z rotation\n");
    Rz(q2, -2.0*phi);
    CNOT(q1, q2);
    Rz(q2, phi);
    CNOT(q1, q2);
}

void ZcrossZ(qbit q1, qbit q2, double phi) {
    // printf("performing sigma_z cross sigma_z Hamiltonian\n");
    Rz(q1, phi);
    Rz(q2, -phi);
    CZ(q1, q2, -2.0*phi);
}


// red pairs
void Red(qbit reg[N], int m) {
  int n;  
  for (n = 0; n < N-1; n += 2) {  
    double phi = J[n] * (2.0*m - 1) / M;
    ZcrossZ(reg[n], reg[n + 1], phi);
  }  
}

// black pairs
void Black(qbit reg[N], int m) {
  int n;  
  for (n = 1; n < N-1; n += 2) {  
    double phi = J[n] * (2.0*m - 1) / M;
    ZcrossZ(reg[n], reg[n + 1], phi);
  }  
}

// Bz Hamiltonian
void Inter(qbit reg[N], int m) {
  int n;  
  double theta1 = (1.0 - (2.0*m-1)/M) * -2 * Bx * T / M;
  for (n = 0; n < N; n++) {
    double theta2 = (1.0 - (2.0*m-1)/M) * -2 * Bz[n] * T / M;          
    H(reg[n]);
    Rz(reg[n], theta1);
    H(reg[n]);
    Rz(reg[n], theta2);            
  }  
}

int main() {
    qbit reg[N];

    // Initialize all qubits to |+> state
    int n;
    for(n=0; n < N; n++) {
        PrepZ(reg[n], 0);
        H(reg[n]);
    }

    double dt = M / T;  // time per Trotter step

    int m;
    for(m = 1; m <= M; m++) {

        // Z-Z hamiltonian, executed in parallel
        Red (reg, m);
        
        Black (reg, m);

        Inter (reg, m);

    }

    for (n = 0; n < N; n++) {
        MeasZ(reg[0]);
    }

    return 0;
}
